"use strict";(self["webpackChunkvue3_test"]=self["webpackChunkvue3_test"]||[]).push([[288],{288:function(e,t,a){a.r(t),a.d(t,{default:function(){return f}});var s=a(6252);const o={style:{border:"1px solid #ccc","text-align":"left",height:"800px","min-width":"1000px","max-width":"1100px"}};function r(e,t,a,r,n,i){const l=(0,s.up)("v-md-editor"),u=(0,s.up)("a-col"),d=(0,s.up)("a-date-picker"),p=(0,s.up)("a-form-item"),c=(0,s.up)("a-input"),m=(0,s.up)("a-select"),g=(0,s.up)("a-button"),f=(0,s.up)("a-form"),h=(0,s.up)("a-card"),v=(0,s.up)("a-space"),y=(0,s.up)("a-layout-content"),w=(0,s.up)("a-layout"),S=(0,s.up)("NotificationComponent");return(0,s.wg)(),(0,s.iD)("div",null,[(0,s.Wm)(w,null,{default:(0,s.w5)((()=>[(0,s.Wm)(y,null,{default:(0,s.w5)((()=>[(0,s.Wm)(v,{size:e.small,direction:"horizontal",align:"start"},{default:(0,s.w5)((()=>[(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s._)("div",o,[(0,s.Wm)(l,{modelValue:e.formState.user.content,"onUpdate:modelValue":t[0]||(t[0]=t=>e.formState.user.content=t),height:"800px"},null,8,["modelValue"])])])),_:1}),(0,s.Wm)(u,{style:{"background-color":"#fff"},flex:"fix"},{default:(0,s.w5)((()=>[(0,s.Wm)(h,{style:{width:"300px","border-radius":"20px"},hoverable:""},{default:(0,s.w5)((()=>[(0,s.Wm)(f,{model:e.formState,name:"nest-messages",onFinish:e.onFinish,onOnFinishFailed:e.onFinishFailed,"validate-messages":e.validateMessages},{default:(0,s.w5)((()=>[(0,s.Wm)(p,{name:["user","createTime"],label:"日期",rules:[{required:!0,message:"选择日期"}]},{default:(0,s.w5)((()=>[(0,s.Wm)(d,{value:e.formState.user.createTime,"onUpdate:value":t[1]||(t[1]=t=>e.formState.user.createTime=t),"show-time":"",format:"YYYY-MM-DD HH:mm:ss","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["value"])])),_:1}),(0,s.Wm)(p,{name:["user","title"],label:"文章标题",rules:[{required:!0,message:"填写文章标题"}]},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{value:e.formState.user.title,"onUpdate:value":t[2]||(t[2]=t=>e.formState.user.title=t)},null,8,["value"])])),_:1}),(0,s.Wm)(p,{name:["user","description"],label:"文章描述",rules:[{required:!0,message:"填写文章描述"}]},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{value:e.formState.user.description,"onUpdate:value":t[3]||(t[3]=t=>e.formState.user.description=t)},null,8,["value"])])),_:1}),(0,s.Wm)(p,{name:["user","articleImg"],label:"文章图片"},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{value:e.formState.user.titleImgs,"onUpdate:value":t[4]||(t[4]=t=>e.formState.user.titleImgs=t),placeholder:"空则使用默认图片"},null,8,["value"])])),_:1}),(0,s.Wm)(p,{name:["user","categorys"],label:"栏目选择"},{default:(0,s.w5)((()=>[(0,s.Wm)(m,{showSearch:"",value:e.categoryOptions,"onUpdate:value":t[5]||(t[5]=t=>e.categoryOptions=t),mode:"single",style:{width:"100%"},placeholder:"请选择栏目",options:e.categorys},null,8,["value","options"])])),_:1}),(0,s.Wm)(p,{name:["user","keywords"],label:"关键词"},{default:(0,s.w5)((()=>[(0,s.Wm)(m,{showSearch:"",value:e.keywordOptions,"onUpdate:value":t[6]||(t[6]=t=>e.keywordOptions=t),mode:"multiple",style:{width:"100%"},placeholder:"请选择关键词",options:e.keywords},null,8,["value","options"])])),_:1}),(0,s.Wm)(p,null,{default:(0,s.w5)((()=>[(0,s.Wm)(g,{shape:"round",type:"primary","html-type":"submit"},{default:(0,s.w5)((()=>[(0,s.Uk)("提交")])),_:1})])),_:1})])),_:1},8,["model","onFinish","onOnFinishFailed","validate-messages"])])),_:1})])),_:1})])),_:1},8,["size"])])),_:1})])),_:1}),(0,s.Wm)(S,{ref:"openNotification"},null,512)])}a(7658);var n=a(2262),i=a(5951),l=a(2201),u=a(196),d=a(3907),p=a(1446),c=(0,s.aZ)({name:"EditFramework",setup(){const e=(0,l.tv)(),t=(0,l.yj)(),a=(0,d.oR)(),o=(0,n.iH)(),r=(0,n.iH)(),i=(0,n.iH)([]),c=(0,n.iH)([]),m=(0,n.iH)([]),g=(0,n.iH)([]),f=(0,n.iH)([]),h=(0,n.iH)(),v=(0,n.iH)(!0),y=(0,n.qj)({user:{author:"",title:"",content:"",keywords:[],description:"",category:"",titleImgs:"",createTime:""}}),w=()=>{const e=t.query.articleId??"0";if("0"!==e){v.value=!1;var s=new URLSearchParams;s.append("op","getArticleById"),s.append("id",e),u.ZP.post(a.state.path+"/info.action",s).then((e=>{1==e.data.code?(y.user=e.data.data,f.value=e.data.data.label.split(","),h.value=JSON.parse(sessionStorage.getItem("categorys"))[e.data.data.categoryId],sessionStorage.setItem("articleDetail",JSON.stringify(y))):console.log(e.data.msg)})).catch((function(e){console.log(e)}))}};var S;(0,s.bv)((()=>{y.user.content=y.user.content??"",m.value=JSON.parse(sessionStorage.getItem("keywords"))??[],Object.entries(m.value).forEach((([e,t])=>{c.value.push({index:e,value:t})})),g.value=JSON.parse(sessionStorage.getItem("categorys"))??[],Object.entries(g.value).forEach((([e,t])=>{i.value.push({index:e,value:t})})),w(),S=new WebSocket(a.state.wspath+"/websocket")}));const b=s=>{if(console.log(y.user),null!=y.user.content&&void 0!=y.user.content&&""!=y.user.content){console.log(s);var o=new URLSearchParams;v.value?(o.append("op","addArticle"),o.append("author",JSON.parse(sessionStorage.getItem("user")).username),o.append("title",y.user.title),o.append("content",y.user.content),o.append("description",y.user.description),o.append("categoryId",JSON.parse(sessionStorage.getItem("categorys")).indexOf(h.value)+1??1),o.append("label",f.value??""),o.append("titleImgs",y.user.titleImgs??JSON.parse(sessionStorage.getItem("user")).head),o.append("createTime",y.user.createTime),u.ZP.post(a.state.path+"/info.action",o).then((t=>{if(1==t.data.code){y.user.author=JSON.parse(sessionStorage.getItem("user")).username,y.user.category=h.value,y.user.keywords=f.value;let a=JSON.stringify({id:t.data.msg,author:y.user.author,title:y.user.title,content:y.user.content,description:y.user.description,category:JSON.parse(sessionStorage.getItem("categorys")).indexOf(y.user.category),keywords:y.user.keywords,titleImgs:y.user.titleImgs,createTime:y.user.createTime,colCnt:[0,0,0]});S.send(a),p.ZP.success("文章发布成功"),e.push("/")}else p.ZP.error("文章发布失败")})).catch((function(e){console.log(e)}))):(o.append("op","alterArticle"),o.append("id",t.query.articleId),o.append("author",JSON.parse(sessionStorage.getItem("user")).username),o.append("title",y.user.title),o.append("content",y.user.content),o.append("description",y.user.description),o.append("categoryId",JSON.parse(sessionStorage.getItem("categorys")).indexOf(h.value)+1??1),o.append("label",f.value??""),o.append("titleImgs",y.user.titleImgs??JSON.parse(sessionStorage.getItem("user")).head),o.append("createTime",y.user.createTime),u.ZP.post(a.state.path+"/article.action",o).then((t=>{1==t.data.code?(p.ZP.success("文章修改成功"),e.push("/")):p.ZP.error("文章修改失败")})).catch((function(e){console.log(e)})))}else p.ZP.error("文章内容不能为空")},I=e=>{console.log("Failed:",e)},O={required:"${label} is required!",types:{email:"${label} is not a valid email!",number:"${label} is not a valid number!"},number:{range:"${label} must be between ${min} and ${max}"}};return(0,s.Jd)((()=>{})),{formState:y,categorys:i,keywords:c,getContent:r,keywordOptions:f,categoryOptions:h,openNotification:o,validateMessages:O,mode:"default",onFinish:b,onFinishFailed:I}},components:{NotificationComponent:i.Z},props:{openNotificationWithIcon:{type:Function,required:!0}}}),m=a(3744);const g=(0,m.Z)(c,[["render",r]]);var f=g},5951:function(e,t,a){a.d(t,{Z:function(){return i}});var s=a(473),o=a(6252),r=(0,o.aZ)({name:"NotificationComponent",setup(){const e=(e,t,a)=>{s.Z[e]({message:t,description:a,duration:2})};return{openNotificationWithIcon:e}}});const n=r;var i=n}}]);
//# sourceMappingURL=288.ce368ff8.js.map